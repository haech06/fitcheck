<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Order Summary - FitCheck</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light">
  <div class="container py-5">
    <h3 class="mb-4 text-success">Pembayaran Berhasil!</h3>
    <p>Terima kasih sudah melakukan pembelian di FitCheck.</p>

    <div class="card p-4 mb-4" id="order-details" style="display:none;">
      <h5>Detail Pesanan</h5>
      <ul class="list-unstyled" id="order-list"></ul>
    </div>

    <div id="error-message" class="alert alert-danger" style="display:none;"></div>

    <a href="dashboard-pembeli.html" class="btn btn-primary">Kembali ke Beranda</a>
  </div>

  <script>
    // Ambil parameter dari URL, contoh: konfirmasi.html?id_produk=1&nama_produk=xxx&jumlah=2&total_harga=100000
    const params = new URLSearchParams(window.location.search);

    // Kita akan kirim data ke konfirmasi.php via POST (alamat)
    const data = new URLSearchParams();
    data.append('alamat', 'Alamat contoh dari form atau simpanan');

    // Gabungkan GET parameter ke URL API
    const apiUrl = 'konfirmasi.php?' + params.toString();

    fetch(apiUrl, {
      method: 'POST',
      body: data,
    })
    .then(res => res.json())
    .then(res => {
      if(res.status === 'success') {
        const order = res.order;
        document.getElementById('order-list').innerHTML = `
          <li><strong>Nama Produk:</strong> ${order.nama_produk}</li>
          <li><strong>Jumlah:</strong> ${order.jumlah} set</li>
          <li><strong>Total Harga:</strong> Rp${Number(order.total_harga).toLocaleString('id-ID')}</li>
          <li><strong>Alamat Pengiriman:</strong> ${order.alamat.replace(/\n/g, '<br>')}</li>
          <li><strong>Metode Pembayaran:</strong> ${order.metode_pembayaran}</li>
          <li><strong>Status Pesanan:</strong> ${order.status}</li>
          <li><strong>Waktu Checkout:</strong> ${order.waktu_checkout}</li>
        `;
        document.getElementById('order-details').style.display = 'block';
      } else {
        document.getElementById('error-message').textContent = res.message || 'Terjadi kesalahan.';
        document.getElementById('error-message').style.display = 'block';
      }
    })
    .catch(err => {
      document.getElementById('error-message').textContent = 'Gagal mengambil data: ' + err.message;
      document.getElementById('error-message').style.display = 'block';
    });
  </script>
</body>
</html>
